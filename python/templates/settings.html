{% extends '_base.html' %}

{% block content %}
    <div class="row">
        <form>
            {{ form_html|safe }}
        </form>
    </div>

    <script>
        var connection = new WebSocket('ws://' + window.location.host + '/ws/settings');

        connection.onmessage = function(e) {
            console.log(e.data);

            var received_json = JSON.parse(e.data);

            if (received_json.status == 200) {
                // TODO: element id comes from Widget.get_html_id. May pass prefix via template.
                var input_field = document.getElementById('id_' + received_json.fqid);
                input_field.value = received_json.value;
            }
        };

        document.addEventListener("DOMContentLoaded", function (event) {
            // TODO: add showSaveCancelButtons as onfocus Event to input (select, textarea) fields.
        });

        function showSaveCancelButtons(parent) {
            // onfocus
            // TODO: mind other element types like select or textarea. Use css class as filter instead?
            let element = parent.getElementsByTagName('input')[0];
            element.parentElement.innerHTML = '<a onclick="saveOnClick(this.parentElement)">Save</a>' +
                '<a onclick="cancelOnClick(this.parentElement)">Cancel</a>' +
                element.parentElement.innerHTML;
        }

        function hideSaveCancelButtons(element) {

        }

        function saveOnClick(element) {

        }

        function cancelOnClick(element) {

        }
    </script>
{% endblock content %}
